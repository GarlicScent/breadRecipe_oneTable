<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>ONE TABLE</title>

    <!-- jquery -->
    <script
      src="https://code.jquery.com/jquery-3.6.0.min.js"
      integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
      crossorigin="anonymous"
    ></script>
    <!--  -->
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.27.2/axios.min.js"
      integrity="sha512-odNmoc1XJy5x1TMVMdC7EMs3IVdItLPlCeL5vSUPN2llYKMJ2eByTTAIiiuqLg+GdNr9hF6z81p27DArRFKT7A=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <!-- 네브바 fontawesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css"
      integrity="sha512-xh6O/CkQoPOWDdYTDqeRdPCVd1SpvCA9XXcUnZS2FmJNp1coAFzvtCN9BmamE+4aHK8yyUHUSCcJHgXloTyT2A=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link rel="stylesheet" href="/static/css/navbar.css" />
    <link rel="stylesheet" href="/static/css/footer.css" />
    <!-- 부트스트랩 -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
      crossorigin="anonymous"
    ></script>
    <!-- 슬라이드 라이브러리 CDN -->
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.css"
    />
    <script
      type="text/javascript"
      src="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js"
    ></script>
    <!-- axios -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <link
      rel="stylesheet"
      href="https://cdn-uicons.flaticon.com/uicons-regular-rounded/css/uicons-regular-rounded.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css"
      integrity="sha512-xh6O/CkQoPOWDdYTDqeRdPCVd1SpvCA9XXcUnZS2FmJNp1coAFzvtCN9BmamE+4aHK8yyUHUSCcJHgXloTyT2A=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />

    <style>
      @import url(//fonts.googleapis.com/earlyaccess/notosanskr.css);

      body {
        font-family: var(--sub-font-family);
        background-color: rgb(236, 236, 236);
      }
      .register-all {
        background-color: white;
        /* border: 1px dotted blue; */
        width: 80vw;
        margin: 20px auto;
        padding: 10px;
      }
      .register {
        /* border: 1px dotted red; */
      }
      .register > h3 {
        padding: 10px;
      }
      .img-register > img {
        width: 150px;
        height: 150px;
        margin: 10px;
      }

      .register-inform-child > div > label {
        display: inline-block;
        margin: 10px 16px;
      }
      .number {
        display: flex;
      }
      .register-inform {
        display: flex;
        justify-content: center;
      }
      /* 등록버튼 */
      .register-button {
        text-align: center;
      }

      .register-button > button {
        width: 200px;
        height: 50px;
        background-color: #aa8a72;
        border: 0px;
        border-radius: 10px;
        color: white;
        margin: 30px 0px;
      }
      /* 파일업로드 인풋 */
      #file {
        display: none;
      }
      label[for="file"] {
        text-align: center;
        background-color: rgb(235, 235, 235);
        width: 200px;
        height: 200px;
        border-radius: 20px;
        margin-left: 50px;
      }
      label[for="file"] > i {
        font-size: 50px;
      }
      #totalNumber {
        width: 80px;
      }
      #hour {
        width: 80px;
      }
      .register-inform-child input {
        width: 350px;
        height: 29px;
        padding: 10px;
        border-radius: 10px;
        border: 0px;
        background-color: rgb(226, 226, 226);
        margin: 0px 10px;
        font-size: 12px;
      }
      #intro {
        height: 60px !important;
      }
      .course-information {
        display: flex;
        align-items: center;
        padding-left: 12px;
      }
      #inform-hour {
        padding-left: 20px;
      }
      .represent > i {
        font-size: 50px;
      }

      /* 이미지 업로드된 후 add class */
      .d-none {
        display: none;
      }
      .afterImg {
        width: 100%;
        height: 100%;
        border-radius: 20px;
      }
      
    </style>
  </head>

  <body>
    <%-include("navbar.ejs")%>

    <div class="register-all">
      <div class="register">
        <h3>클래스 등록</h3>
        <hr />
        <div class="register-inform">
          <form class="register-inform-child" id="registerForm">
            <div>
              <label for="name" class="label">클래스 제목</label>
              <input type="text" name="name" id="name" />
            </div>
            <div>
              <label for="intro" class="label">클래스 설명</label>
              <input type="text" name="intro" id="intro" />
            </div>
            <div>
              <label for="price">클래스 금액</label>
              <input type="text" name="price" id="price"/>원
            </div>
            <div>
              <label for="date">클래스 날짜</label>
              <input type="date" name="date" id="date"/>
            </div>
            <div class="number">
              <label for="totalNumber">클래스 정보</label>
              <div class="course-information">
                <span>정원</span>
                <input type="text" name="totalNumber" id="totalNumber" />
                <span>명</span>
                <span id="inform-hour">시간</span><input type="text" name="hour" id="hour" />
                <span>분</span>
              </div>
            </div>
          </form>
          <form id="image-register">
            <label class="input-file-button" for="file">
              <img id="preview" />
              <div class="represent">
                <i class="fa-solid fa-camera"></i> <br />
              클래스 대표사진을 <br />선택하세요.</div>
              
            </label>
            <input type="file" name="courseImage" id="file" onchange="readURL(this);"/>
            <!-- <img id="preview" /> -->
          </form>
        </div>
      </div>
      <div class="register-button">
        <button onclick="register();">등록</button>
        <button>취소</button>
      </div>
    </div>
    <%-include("footer.ejs")%>

    <script>
      function register() {
        let form = document.getElementById("registerForm");
        const formData = new FormData();
        const file = document.getElementById("file");
        formData.append("courseImage", file.files[0]);
        formData.append("name", form.name.value);
        formData.append("intro", form.intro.value);
        formData.append("price", form.price.value);
        formData.append("hour", form.hour.value);
        formData.append("date", form.date.value);
        formData.append("totalNumber", form.totalNumber.value);

        axios({
          headers: {
            "Content-Type": "multipart/form-data",
          },
          method: "post",
          url: "http://localhost:8000/course/register",
          data: formData,
        }).then((response) => {
          document.location.href = "/course";
          console.log(response.data);
        });
      }

      let image_change;

      function readURL(input){
        if (input.files && input.files[0]) {
          var reader = new FileReader();
          reader.onload = function(e){
            document.getElementById('preview').src = e.target.result;
          };
          console.log("성공");
          reader.readAsDataURL(input.files[0]);
          $(".represent").addClass("d-none");
          $(".input-file-button > img").addClass("afterImg");
          image_change = true;
        } else {
          document.getElementById('preview').src = "";
        }
      }

    </script>
  </body>
</html>
